# Implementation Plan: Social Profile & Follow System

**Branch**: `001-social-profile` | **Date**: 2026-02-08 | **Spec**: [spec.md](spec.md)
**Input**: Feature specification from `/specs/001-social-profile/spec.md`

## Summary

Build a Symfony 7.2 web application with user registration
(email/password), a multi-step profile wizard, a searchable
paginated user directory, and a follow request system with
approval/rejection. Server-rendered with Twig, backed by SQLite
via Doctrine ORM, tested with PHPUnit following TDD.

## Technical Context

**Language/Version**: PHP 8.2+ with Symfony 7.2 LTS
**Primary Dependencies**: symfony/security-bundle, doctrine/orm,
  vich/uploader-bundle, knplabs/knp-paginator-bundle,
  symfony/form, symfony/validator, symfony/twig-bundle
**Storage**: SQLite (via Doctrine ORM)
**Testing**: PHPUnit via symfony/test-pack,
  dama/doctrine-test-bundle for DB isolation
**Target Platform**: Linux/macOS development server
**Project Type**: Single web application
**Performance Goals**: All actions < 2s response (SC-006),
  100 concurrent users (SC-005)
**Constraints**: Minimal dependencies (Constitution III),
  no external services
**Scale/Scope**: Sample/learning project, ~10 templates,
  5 controllers, 3 entities

## Constitution Check

*GATE: Must pass before Phase 0 research. Re-check after
Phase 1 design.*

### I. Test-First (NON-NEGOTIABLE)

- [ ] PHPUnit test suite configured before first feature code
- [ ] Unit tests for every service class
- [ ] Integration tests for every controller action
- [ ] Database tests use DAMA transaction isolation
- [ ] Red-green-refactor cycle enforced in task ordering

**Status**: PASS — Tasks are ordered tests-first per user story.

### II. Symfony Conventions & API-First Design

- [ ] Symfony Flex directory structure used
- [ ] Dependency injection via autowiring only
- [ ] Symfony attributes for routing, validation, ORM mapping
- [ ] Route contracts defined before controller implementation
- [ ] Symfony Serializer not needed (server-rendered HTML, not
  JSON API)

**Status**: PASS — Route contracts in `contracts/routes.md`.
Serializer exemption: this is a server-rendered app, not an API.
Constitution says "API endpoints MUST be designed contract-first"
— no API endpoints exist, so the gate is satisfied. Routes are
still designed contract-first.

### III. Simplicity (YAGNI)

- [ ] No unnecessary abstractions or patterns
- [ ] Minimal Composer dependencies (all justified in research)
- [ ] No repository pattern (use Doctrine repositories directly)
- [ ] No service layer where controller logic suffices
- [ ] SQLite chosen to avoid infrastructure complexity

**Status**: PASS — Each dependency maps to a specific FR.
FollowRequest consolidates Follow entity (simpler model).

## Project Structure

### Documentation (this feature)

```text
specs/001-social-profile/
├── plan.md
├── research.md
├── data-model.md
├── quickstart.md
├── contracts/
│   └── routes.md
├── checklists/
│   └── requirements.md
└── tasks.md              (generated by /speckit.tasks)
```

### Source Code (repository root)

```text
src/
├── Controller/
│   ├── RegistrationController.php
│   ├── SecurityController.php
│   ├── ProfileController.php
│   ├── UserController.php
│   └── FollowController.php
├── Entity/
│   ├── User.php
│   ├── Profile.php
│   └── FollowRequest.php
├── Form/
│   ├── RegistrationType.php
│   ├── ProfileWizardType.php
│   └── ProfileEditType.php
├── Repository/
│   ├── UserRepository.php
│   ├── ProfileRepository.php
│   └── FollowRequestRepository.php
├── EventSubscriber/
│   └── ProfileWizardSubscriber.php
└── Kernel.php

config/
├── packages/
│   ├── doctrine.yaml
│   ├── security.yaml
│   ├── twig.yaml
│   └── vich_uploader.yaml
├── routes.yaml
└── services.yaml

templates/
├── base.html.twig
├── registration/
│   └── register.html.twig
├── security/
│   └── login.html.twig
├── profile/
│   ├── wizard.html.twig
│   ├── edit.html.twig
│   └── show.html.twig
├── user/
│   └── directory.html.twig
└── follow/
    ├── pending.html.twig
    ├── followers.html.twig
    └── following.html.twig

tests/
├── Controller/
│   ├── RegistrationControllerTest.php
│   ├── SecurityControllerTest.php
│   ├── ProfileControllerTest.php
│   ├── UserControllerTest.php
│   └── FollowControllerTest.php
├── Entity/
│   ├── UserTest.php
│   ├── ProfileTest.php
│   └── FollowRequestTest.php
└── Repository/
    ├── UserRepositoryTest.php
    ├── ProfileRepositoryTest.php
    └── FollowRequestRepositoryTest.php

migrations/
public/
  uploads/
    photos/
```

**Structure Decision**: Standard Symfony Flex single-project
layout. No frontend/backend split — server-rendered HTML with
Twig. Test directory mirrors `src/` structure. Upload directory
under `public/` for direct serving.

## Complexity Tracking

> No Constitution Check violations. No complexity justifications
> needed.
